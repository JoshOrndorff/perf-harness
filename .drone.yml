workspace:
  base: /workdir
  path: rchain-perf-harness

pipeline:

  start-bootstrap:
    image: rchain/rnode:master
    detach: true
    commands:
      - /opt/docker/bin/rnode -c ./drone/config/bootstrap.toml run

  start-validator1:
    image: rchain/rnode:master
    detach: true
    commands:
      - sleep 15
      - /opt/docker/bin/rnode -c ./drone/config/validator1.toml run

  deploy:
    image: rchain/rnode:master
    commands:
      - sleep 15
      - /opt/docker/bin/rnode --grpc-port 30015 deploy --from "0x1" --phlo-limit 0 --phlo-price 0 --nonce 0 drone/config/contracts/performance/loop_recursive.rho

  propose:
    image: rchain/rnode:master
    commands:
      - /opt/docker/bin/rnode -c ./drone/config/bootstrap.toml propose
